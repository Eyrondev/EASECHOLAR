<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports - Admin - EASECHOLAR</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eef2ff', 100: '#e0e7ff', 200: '#c7d2fe', 300: '#a5b4fc', 400: '#818cf8',
                            500: '#6366f1', 600: '#4f46e5', 700: '#4338ca', 800: '#3730a3', 900: '#312e81',
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Mobile Responsive Styles -->
    <link rel="stylesheet" href="/Assets/css/mobile-responsive.css">

    <script src="components.js"></script>
</head>
<body class="bg-gray-50 font-sans">
    <div id="sidebar-container"></div>
    <div id="nav-container"></div>

    <div class="ml-64 pt-16">
        <div class="p-8">
            <div id="header-container"></div>

            <!-- Report Types -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <!-- User Reports -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-blue-100 rounded-full">
                            <i class="fas fa-users text-blue-600 text-2xl"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-500">User Reports</span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">User Analytics</h3>
                    <p class="text-sm text-gray-600 mb-4">Student and provider registration trends, demographics, and activity</p>
                    <button onclick="generateUserReport()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                        <i class="fas fa-chart-line mr-2"></i>Generate Report
                    </button>
                </div>

                <!-- Scholarship Reports -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-green-100 rounded-full">
                            <i class="fas fa-graduation-cap text-green-600 text-2xl"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-500">Scholarship Reports</span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Scholarship Analytics</h3>
                    <p class="text-sm text-gray-600 mb-4">Scholarship trends, types, amounts, and provider statistics</p>
                    <button onclick="generateScholarshipReport()" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                        <i class="fas fa-chart-bar mr-2"></i>Generate Report
                    </button>
                </div>

                <!-- Application Reports -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-purple-100 rounded-full">
                            <i class="fas fa-file-alt text-purple-600 text-2xl"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-500">Application Reports</span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Application Analytics</h3>
                    <p class="text-sm text-gray-600 mb-4">Application trends, success rates, and processing times</p>
                    <button onclick="generateApplicationReport()" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                        <i class="fas fa-chart-pie mr-2"></i>Generate Report
                    </button>
                </div>
            </div>

            <!-- System Overview -->
            <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                    <i class="fas fa-chart-line text-indigo-600 mr-2"></i>
                    System Overview
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-users text-blue-600 mr-3"></i>
                            <span class="text-sm font-medium text-gray-700">Total Users</span>
                        </div>
                        <span id="overview-users" class="text-lg font-bold text-gray-900">0</span>
                    </div>
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-graduation-cap text-green-600 mr-3"></i>
                            <span class="text-sm font-medium text-gray-700">Scholarships</span>
                        </div>
                        <span id="overview-scholarships" class="text-lg font-bold text-gray-900">0</span>
                    </div>
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-file-alt text-purple-600 mr-3"></i>
                            <span class="text-sm font-medium text-gray-700">Applications</span>
                        </div>
                        <span id="overview-applications" class="text-lg font-bold text-gray-900">0</span>
                    </div>
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-clock text-yellow-600 mr-3"></i>
                            <span class="text-sm font-medium text-gray-700">Pending Approvals</span>
                        </div>
                        <span id="overview-pending" class="text-lg font-bold text-gray-900">0</span>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-history text-indigo-600 mr-2"></i>
                        Recent Activity Log
                    </h3>
                    <button onclick="refreshActivity()" class="text-sm text-indigo-600 hover:text-indigo-700 font-medium">
                        <i class="fas fa-sync-alt mr-1"></i>Refresh
                    </button>
                </div>
                <div id="activity-log" class="space-y-3">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Components are loaded automatically by components.js
            loadOverviewStats();
            loadActivityLog();
        });

        function loadOverviewStats() {
            fetch('/api/admin/dashboard-stats')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const stats = data.data;
                        document.getElementById('overview-users').textContent = stats.total_users || 0;
                        document.getElementById('overview-scholarships').textContent = stats.total_scholarships || 0;
                        document.getElementById('overview-applications').textContent = stats.total_applications || 0;
                        document.getElementById('overview-pending').textContent = stats.pending_approvals || 0;
                    }
                })
                .catch(error => console.error('Error loading stats:', error));
        }

        function loadActivityLog() {
            const activityLog = document.getElementById('activity-log');
            activityLog.innerHTML = `
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-spinner fa-spin text-2xl mb-2 block"></i>
                    <p class="text-sm">Loading activity...</p>
                </div>
            `;

            // Simulated activity for now - replace with actual API call
            setTimeout(() => {
                activityLog.innerHTML = `
                    <div class="flex items-start p-3 bg-gray-50 rounded-lg">
                        <i class="fas fa-user-plus text-green-600 mt-1 mr-3"></i>
                        <div class="flex-1">
                            <p class="text-sm text-gray-900">New student registered</p>
                            <p class="text-xs text-gray-500">2 hours ago</p>
                        </div>
                    </div>
                    <div class="flex items-start p-3 bg-gray-50 rounded-lg">
                        <i class="fas fa-check text-blue-600 mt-1 mr-3"></i>
                        <div class="flex-1">
                            <p class="text-sm text-gray-900">User approved by admin</p>
                            <p class="text-xs text-gray-500">5 hours ago</p>
                        </div>
                    </div>
                    <div class="flex items-start p-3 bg-gray-50 rounded-lg">
                        <i class="fas fa-graduation-cap text-purple-600 mt-1 mr-3"></i>
                        <div class="flex-1">
                            <p class="text-sm text-gray-900">New scholarship posted</p>
                            <p class="text-xs text-gray-500">1 day ago</p>
                        </div>
                    </div>
                `;
            }, 1000);
        }

        function refreshActivity() {
            loadActivityLog();
        }

        function generateUserReport() {
            // Create report window
            const reportWindow = window.open('', '_blank', 'width=800,height=600');
            
            // Fetch user data
            fetch('/api/admin/users')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const users = data.users || [];
                        const students = users.filter(u => u.user_type === 'STUDENT');
                        const providers = users.filter(u => u.user_type === 'PROVIDER');
                        const admins = users.filter(u => u.user_type === 'ADMIN');
                        
                        reportWindow.document.write(`
                            <!DOCTYPE html>
                            <html>
                            <head>
                                <title>User Analytics Report - EASESCHOLAR</title>
                                <style>
                                    * { margin: 0; padding: 0; box-sizing: border-box; }
                                    body { font-family: 'Arial', sans-serif; padding: 40px; background: white; }
                                    .container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border: 2px solid #000; }
                                    .header { text-align: center; margin-bottom: 40px; border-bottom: 3px solid #000; padding-bottom: 20px; }
                                    .header h1 { color: #000; font-size: 28px; margin-bottom: 10px; }
                                    .header p { color: #333; font-size: 14px; }
                                    .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 30px 0; }
                                    .stat-card { background: #f5f5f5; color: #000; padding: 20px; border: 2px solid #000; text-align: center; }
                                    .stat-card h3 { font-size: 36px; margin-bottom: 5px; font-weight: bold; }
                                    .stat-card p { font-size: 14px; }
                                    .section { margin: 30px 0; }
                                    .section h2 { color: #000; font-size: 20px; margin-bottom: 15px; border-left: 4px solid #000; padding-left: 12px; font-weight: bold; }
                                    table { width: 100%; border-collapse: collapse; margin-top: 15px; border: 1px solid #000; }
                                    th, td { padding: 12px; text-align: left; border: 1px solid #000; }
                                    th { background: #e5e5e5; color: #000; font-weight: 600; }
                                    .footer { text-align: center; margin-top: 40px; padding-top: 20px; border-top: 2px solid #000; color: #333; font-size: 12px; }
                                    .print-btn { background: #000; color: white; padding: 12px 30px; border: none; cursor: pointer; font-size: 16px; margin: 20px auto; display: block; }
                                    .print-btn:hover { background: #333; }
                                    @media print {
                                        .print-btn { display: none; }
                                        body { padding: 0; }
                                        .container { border: none; }
                                    }
                                </style>
                            </head>
                            <body>
                                <div class="container">
                                    <div class="header">
                                        <h1>üìä User Analytics Report</h1>
                                        <p>EASESCHOLAR Scholarship Management Platform</p>
                                        <p>Generated on ${new Date().toLocaleString()}</p>
                                    </div>
                                    
                                    <button class="print-btn" onclick="window.print()">üñ®Ô∏è Print Report</button>
                                    
                                    <div class="stats-grid">
                                        <div class="stat-card">
                                            <h3>${users.length}</h3>
                                            <p>Total Users</p>
                                        </div>
                                        <div class="stat-card">
                                            <h3>${students.length}</h3>
                                            <p>Students</p>
                                        </div>
                                        <div class="stat-card">
                                            <h3>${providers.length}</h3>
                                            <p>Providers</p>
                                        </div>
                                    </div>
                                    
                                    <div class="section">
                                        <h2>User Distribution</h2>
                                        <table>
                                            <tr>
                                                <th>User Type</th>
                                                <th>Count</th>
                                                <th>Percentage</th>
                                            </tr>
                                            <tr>
                                                <td>Students</td>
                                                <td>${students.length}</td>
                                                <td>${users.length > 0 ? ((students.length / users.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                            <tr>
                                                <td>Providers</td>
                                                <td>${providers.length}</td>
                                                <td>${users.length > 0 ? ((providers.length / users.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                            <tr>
                                                <td>Administrators</td>
                                                <td>${admins.length}</td>
                                                <td>${users.length > 0 ? ((admins.length / users.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                        </table>
                                    </div>
                                    
                                    <div class="section">
                                        <h2>Recent Registrations</h2>
                                        <table>
                                            <tr>
                                                <th>Name</th>
                                                <th>Email</th>
                                                <th>Type</th>
                                                <th>Status</th>
                                            </tr>
                                            ${users.slice(0, 10).map(user => `
                                                <tr>
                                                    <td>${user.first_name} ${user.last_name}</td>
                                                    <td>${user.email}</td>
                                                    <td>${user.user_type}</td>
                                                    <td>${user.is_active ? '‚úÖ Active' : '‚ùå Inactive'}</td>
                                                </tr>
                                            `).join('')}
                                        </table>
                                    </div>
                                    
                                    <div class="footer">
                                        <p><strong>EASESCHOLAR</strong> - Scholarship Management Platform</p>
                                        <p>¬© 2025 EASESCHOLAR. All rights reserved.</p>
                                    </div>
                                </div>
                            </body>
                            </html>
                        `);
                        reportWindow.document.close();
                    }
                })
                .catch(error => {
                    console.error('Error generating report:', error);
                    alert('Failed to generate user report. Please try again.');
                    reportWindow.close();
                });
        }

        function generateScholarshipReport() {
            // Create report window
            const reportWindow = window.open('', '_blank', 'width=800,height=600');
            
            // Fetch scholarship data
            fetch('/api/admin/scholarships')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const scholarships = data.scholarships || [];
                        const active = scholarships.filter(s => s.status === 'ACTIVE');
                        const closed = scholarships.filter(s => s.status === 'CLOSED');
                        const totalAmount = scholarships.reduce((sum, s) => sum + (parseFloat(s.amount) || 0), 0);
                        
                        reportWindow.document.write(`
                            <!DOCTYPE html>
                            <html>
                            <head>
                                <title>Scholarship Analytics Report - EASESCHOLAR</title>
                                <style>
                                    * { margin: 0; padding: 0; box-sizing: border-box; }
                                    body { font-family: 'Arial', sans-serif; padding: 40px; background: white; }
                                    .container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border: 2px solid #000; }
                                    .header { text-align: center; margin-bottom: 40px; border-bottom: 3px solid #000; padding-bottom: 20px; }
                                    .header h1 { color: #000; font-size: 28px; margin-bottom: 10px; }
                                    .header p { color: #333; font-size: 14px; }
                                    .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 30px 0; }
                                    .stat-card { background: #f5f5f5; color: #000; padding: 20px; border: 2px solid #000; text-align: center; }
                                    .stat-card h3 { font-size: 36px; margin-bottom: 5px; font-weight: bold; }
                                    .stat-card p { font-size: 14px; }
                                    .section { margin: 30px 0; }
                                    .section h2 { color: #000; font-size: 20px; margin-bottom: 15px; border-left: 4px solid #000; padding-left: 12px; font-weight: bold; }
                                    table { width: 100%; border-collapse: collapse; margin-top: 15px; border: 1px solid #000; }
                                    th, td { padding: 12px; text-align: left; border: 1px solid #000; }
                                    th { background: #e5e5e5; color: #000; font-weight: 600; }
                                    .footer { text-align: center; margin-top: 40px; padding-top: 20px; border-top: 2px solid #000; color: #333; font-size: 12px; }
                                    .print-btn { background: #000; color: white; padding: 12px 30px; border: none; cursor: pointer; font-size: 16px; margin: 20px auto; display: block; }
                                    .print-btn:hover { background: #333; }
                                    @media print {
                                        .print-btn { display: none; }
                                        body { padding: 0; }
                                        .container { border: none; }
                                    }
                                </style>
                            </head>
                            <body>
                                <div class="container">
                                    <div class="header">
                                        <h1>üéì Scholarship Analytics Report</h1>
                                        <p>EASESCHOLAR Scholarship Management Platform</p>
                                        <p>Generated on ${new Date().toLocaleString()}</p>
                                    </div>
                                    
                                    <button class="print-btn" onclick="window.print()">üñ®Ô∏è Print Report</button>
                                    
                                    <div class="stats-grid">
                                        <div class="stat-card">
                                            <h3>${scholarships.length}</h3>
                                            <p>Total Scholarships</p>
                                        </div>
                                        <div class="stat-card">
                                            <h3>${active.length}</h3>
                                            <p>Active</p>
                                        </div>
                                        <div class="stat-card">
                                            <h3>‚Ç±${totalAmount.toLocaleString()}</h3>
                                            <p>Total Amount</p>
                                        </div>
                                    </div>
                                    
                                    <div class="section">
                                        <h2>Scholarship Status Distribution</h2>
                                        <table>
                                            <tr>
                                                <th>Status</th>
                                                <th>Count</th>
                                                <th>Percentage</th>
                                            </tr>
                                            <tr>
                                                <td>Active</td>
                                                <td>${active.length}</td>
                                                <td>${scholarships.length > 0 ? ((active.length / scholarships.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                            <tr>
                                                <td>Closed</td>
                                                <td>${closed.length}</td>
                                                <td>${scholarships.length > 0 ? ((closed.length / scholarships.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                        </table>
                                    </div>
                                    
                                    <div class="section">
                                        <h2>Recent Scholarships</h2>
                                        <table>
                                            <tr>
                                                <th>Title</th>
                                                <th>Amount</th>
                                                <th>Deadline</th>
                                                <th>Status</th>
                                            </tr>
                                            ${scholarships.slice(0, 10).map(s => `
                                                <tr>
                                                    <td>${s.title}</td>
                                                    <td>‚Ç±${parseFloat(s.amount).toLocaleString()}</td>
                                                    <td>${s.deadline ? new Date(s.deadline).toLocaleDateString() : 'N/A'}</td>
                                                    <td>${s.status === 'ACTIVE' ? '‚úÖ Active' : '‚ùå Closed'}</td>
                                                </tr>
                                            `).join('')}
                                        </table>
                                    </div>
                                    
                                    <div class="footer">
                                        <p><strong>EASESCHOLAR</strong> - Scholarship Management Platform</p>
                                        <p>¬© 2025 EASESCHOLAR. All rights reserved.</p>
                                    </div>
                                </div>
                            </body>
                            </html>
                        `);
                        reportWindow.document.close();
                    }
                })
                .catch(error => {
                    console.error('Error generating report:', error);
                    alert('Failed to generate scholarship report. Please try again.');
                    reportWindow.close();
                });
        }

        function generateApplicationReport() {
            // Create report window
            const reportWindow = window.open('', '_blank', 'width=800,height=600');
            
            // Fetch application data
            fetch('/api/admin/applications')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const applications = data.applications || [];
                        const pending = applications.filter(a => a.status === 'PENDING');
                        const approved = applications.filter(a => a.status === 'APPROVED');
                        const rejected = applications.filter(a => a.status === 'REJECTED');
                        const underReview = applications.filter(a => a.status === 'UNDER_REVIEW');
                        
                        reportWindow.document.write(`
                            <!DOCTYPE html>
                            <html>
                            <head>
                                <title>Application Analytics Report - EASESCHOLAR</title>
                                <style>
                                    * { margin: 0; padding: 0; box-sizing: border-box; }
                                    body { font-family: 'Arial', sans-serif; padding: 40px; background: white; }
                                    .container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border: 2px solid #000; }
                                    .header { text-align: center; margin-bottom: 40px; border-bottom: 3px solid #000; padding-bottom: 20px; }
                                    .header h1 { color: #000; font-size: 28px; margin-bottom: 10px; }
                                    .header p { color: #333; font-size: 14px; }
                                    .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 30px 0; }
                                    .stat-card { background: #f5f5f5; color: #000; padding: 20px; border: 2px solid #000; text-align: center; }
                                    .stat-card h3 { font-size: 32px; margin-bottom: 5px; font-weight: bold; }
                                    .stat-card p { font-size: 13px; }
                                    .section { margin: 30px 0; }
                                    .section h2 { color: #000; font-size: 20px; margin-bottom: 15px; border-left: 4px solid #000; padding-left: 12px; font-weight: bold; }
                                    table { width: 100%; border-collapse: collapse; margin-top: 15px; border: 1px solid #000; }
                                    th, td { padding: 12px; text-align: left; border: 1px solid #000; }
                                    th { background: #e5e5e5; color: #000; font-weight: 600; }
                                    .footer { text-align: center; margin-top: 40px; padding-top: 20px; border-top: 2px solid #000; color: #333; font-size: 12px; }
                                    .print-btn { background: #000; color: white; padding: 12px 30px; border: none; cursor: pointer; font-size: 16px; margin: 20px auto; display: block; }
                                    .print-btn:hover { background: #333; }
                                    @media print {
                                        .print-btn { display: none; }
                                        body { padding: 0; }
                                        .container { border: none; }
                                    }
                                </style>
                            </head>
                            <body>
                                <div class="container">
                                    <div class="header">
                                        <h1>üìÑ Application Analytics Report</h1>
                                        <p>EASESCHOLAR Scholarship Management Platform</p>
                                        <p>Generated on ${new Date().toLocaleString()}</p>
                                    </div>
                                    
                                    <button class="print-btn" onclick="window.print()">üñ®Ô∏è Print Report</button>
                                    
                                    <div class="stats-grid">
                                        <div class="stat-card">
                                            <h3>${applications.length}</h3>
                                            <p>Total</p>
                                        </div>
                                        <div class="stat-card">
                                            <h3>${pending.length}</h3>
                                            <p>Pending</p>
                                        </div>
                                        <div class="stat-card">
                                            <h3>${approved.length}</h3>
                                            <p>Approved</p>
                                        </div>
                                        <div class="stat-card">
                                            <h3>${rejected.length}</h3>
                                            <p>Rejected</p>
                                        </div>
                                    </div>
                                    
                                    <div class="section">
                                        <h2>Application Status Distribution</h2>
                                        <table>
                                            <tr>
                                                <th>Status</th>
                                                <th>Count</th>
                                                <th>Percentage</th>
                                            </tr>
                                            <tr>
                                                <td>Pending</td>
                                                <td>${pending.length}</td>
                                                <td>${applications.length > 0 ? ((pending.length / applications.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                            <tr>
                                                <td>Under Review</td>
                                                <td>${underReview.length}</td>
                                                <td>${applications.length > 0 ? ((underReview.length / applications.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                            <tr>
                                                <td>Approved</td>
                                                <td>${approved.length}</td>
                                                <td>${applications.length > 0 ? ((approved.length / applications.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                            <tr>
                                                <td>Rejected</td>
                                                <td>${rejected.length}</td>
                                                <td>${applications.length > 0 ? ((rejected.length / applications.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                        </table>
                                    </div>
                                    
                                    <div class="section">
                                        <h2>Success Rate</h2>
                                        <table>
                                            <tr>
                                                <th>Metric</th>
                                                <th>Value</th>
                                            </tr>
                                            <tr>
                                                <td>Approval Rate</td>
                                                <td>${applications.length > 0 ? ((approved.length / applications.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                            <tr>
                                                <td>Rejection Rate</td>
                                                <td>${applications.length > 0 ? ((rejected.length / applications.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                            <tr>
                                                <td>Pending Rate</td>
                                                <td>${applications.length > 0 ? (((pending.length + underReview.length) / applications.length) * 100).toFixed(1) : 0}%</td>
                                            </tr>
                                        </table>
                                    </div>
                                    
                                    <div class="footer">
                                        <p><strong>EASESCHOLAR</strong> - Scholarship Management Platform</p>
                                        <p>¬© 2025 EASESCHOLAR. All rights reserved.</p>
                                    </div>
                                </div>
                            </body>
                            </html>
                        `);
                        reportWindow.document.close();
                    }
                })
                .catch(error => {
                    console.error('Error generating report:', error);
                    alert('Failed to generate application report. Please try again.');
                    reportWindow.close();
                });
        }
    </script>

    <!-- Mobile Menu Handler -->
    <script src="/Assets/js/mobile-menu.js"></script>
</body>
</html>
